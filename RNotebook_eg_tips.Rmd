---
output_dir: "."
title: "R Notebook example"
output:
  html_document:
    df_print: paged
---
# Inserting R-code chunks

Three backticks and {r} inserts a code block. Or just press the 'insert' button. 

```{r load-data and arrange, message=FALSE}
# load tidyverse
library(tidyverse)
library(kableExtra) # use for kbl()
library(rmarkdown) # use for paged_table()
library(ggpubr) # use for ggarrange

# read file into R
pop_data <- read_csv("data/gapminder_data.csv")

# transform the data to filter/transfrom rows and display it was a table
# creating a table with data from European countries in 2007 - ordered by life expectancy
# filter for rows, select for columns
euro_data_tbl <- pop_data %>% 
  filter(continent == "Europe" & year == 2007) %>% 
  select(-continent, -year) %>% 
  arrange(desc(lifeExp)) %>% 
  rename(Country = country, "Population Size" = pop, "Life Expectancy"= lifeExp, "GDP" = gdpPercap)
#rename function changes headings without complications; with more than one word, you need to have it in "" marks. 
```

## Chunk options
- include = FALSE do not display the code and results in the page after it is knitted. The R code however still runs and therefore the variables or results in this code chunk can be used by the other chunks.

- echo = FALSE does not display the code, but it displays the results in the rendered file.

- message = FALSE does not display any messages that are generated by the code chunk in the rendered file.

- warning = FALSE does not display warnings that are generated by code chunk in the rendered file.

# Creating and inserting the table 
The results in euro_data_tbl are displayed in the table below:
\

## First way, more complex but customisable
```{r Table 1 - kbl()}
euro_data_tbl %>% 
  kbl() %>% 
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F) %>% 
  scroll_box(width = "100%", height = "300px")

```
This is the [link](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html) for the kable documentation. These can be used for exploring the documentation for customising cool tables. 

## This is a better way to display long tables
```{r Table 2 - paged_table}
paged_table(euro_data_tbl)
```

\

# Inserting images
Next, the life expectancy in Europe is observed across different years. The aim of this is to check if there was a change in life expectancy over the years.  The data used for the life expectancy over the years analysis is the gapminder data and the following data manipulation was performed:

```{r fig-data}
#keep European data and change year to factor
euro_data_fig <- pop_data %>% 
                    filter(continent == "Europe")  %>% 
                    mutate(year=as_factor(year))

```

The life expectancy for Europe over the years is plotted as following:

```{r fig, warning=FALSE, fig.cap="Life Expectancy in Europe over the years"}
#Euro plot
euro_plot <- euro_data_fig %>%
                ggplot(mapping=aes(x=year, y=lifeExp)) +
                geom_violin() +
                stat_summary(fun.y = median, geom = "point")

#draw euro plot, you have to put it in a vector name 
euro_plot

```

## Multiple images

```{r Second plot}
#keep only UK data
uk_data_fig <- pop_data %>% 
  filter(country=="United Kingdom") %>% 
  mutate(year=as_factor(year))

#uk plot
uk_plot <- uk_data_fig %>% 
  ggplot(aes(x=year, y=lifeExp))+
  geom_point()

#use the ggarrange function to allow viewing of both plots; putting em together. just keep adding them with , separating them 
ggarrange(euro_plot, uk_plot, ncol = 2, nrow = 1, labels = "AUTO")

```

